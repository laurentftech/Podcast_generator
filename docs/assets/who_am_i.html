<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Who am I?</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, sans-serif;
      max-width: 800px;
      margin: 1rem auto;
      padding: 0 1rem;
      line-height: 1.6;
      font-size: 16px;
    }

    h1 {
      margin-bottom: 0.5rem;
      font-size: 1.8rem;
    }

    h2 {
      margin-top: 0;
      color: #666;
      font-weight: normal;
      font-size: 1.1rem;
    }

    audio {
      width: 100%;
      margin: 1rem 0;
      min-height: 40px;
      background-color: #f5f5f5;
      border-radius: 8px;
    }

    #transcript {
      font-size: 1rem;
      line-height: 1.7;
      margin-bottom: 2rem;
    }

    .word {
      padding: 2px 4px;
      margin: 0 1px;
      transition: background 0.2s;
      cursor: pointer;
      border-radius: 3px;
      display: inline-block;
    }

    .highlight {
      background-color: #ffc107;
      color: #000;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(255, 193, 7, 0.3);
    }

    strong {
      color: #000;
      font-weight: 600;
    }

    em {
      color: #666;
      font-style: italic;
      font-size: 0.9em;
    }

    footer {
      margin-top: 3rem;
      text-align: center;
      font-size: 0.85rem;
      color: #888;
      padding-bottom: 1rem;
    }

    footer a {
      color: #555;
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    /* Améliorations pour mobile */
    @media (max-width: 768px) {
      body {
        margin: 0.5rem auto;
        padding: 0 0.75rem;
        font-size: 15px;
      }

      h1 {
        font-size: 1.5rem;
        margin-bottom: 0.3rem;
      }

      h2 {
        font-size: 1rem;
        margin-bottom: 1rem;
      }

      audio {
        margin: 0.75rem 0;
        min-height: 45px;
        border-radius: 12px;
        /* Force une hauteur minimum pour éviter la coupure */
        height: 45px;
      }

      #transcript {
        font-size: 0.95rem;
        line-height: 1.6;
      }

      .word {
        padding: 3px 5px;
        margin: 1px 2px;
        /* Améliorer la zone de touch sur mobile */
        min-height: 24px;
        display: inline-flex;
        align-items: center;
      }

      .highlight {
        box-shadow: 0 3px 6px rgba(255, 193, 7, 0.4);
        transform: scale(1.05);
      }

      strong {
        display: block;
        margin: 0.5rem 0 0.2rem 0;
        font-size: 1rem;
      }

      em {
        font-size: 0.85rem;
        margin-right: 0.5rem;
      }

      footer {
        margin-top: 2rem;
        font-size: 0.8rem;
      }
    }

    /* Très petits écrans */
    @media (max-width: 480px) {
      body {
        padding: 0 0.5rem;
        font-size: 14px;
      }

      h1 {
        font-size: 1.3rem;
      }

      audio {
        height: 50px;
        border-radius: 8px;
      }

      #transcript {
        font-size: 0.9rem;
      }

      .word {
        padding: 2px 4px;
        margin: 1px;
      }
    }

    /* Amélioration pour les contrôles audio sur tous les navigateurs */
    audio::-webkit-media-controls-panel {
      background-color: #f8f9fa;
    }

    audio::-webkit-media-controls-play-button,
    audio::-webkit-media-controls-pause-button {
      background-color: #2c5aa0;
      border-radius: 50%;
    }
  </style>
</head>
<body>
  <h1>Who am I?</h1>
  <h2>A simple demo of Podcast generator produced with Google Gemini</h2>
  <audio id="player" controls src="../sample2-gemini.mp3" preload="metadata">
    <p>Votre navigateur ne supporte pas l'élément audio. <a href="../sample2-gemini.mp3">Télécharger le fichier audio</a>.</p>
  </audio>
  <div id="transcript"><span class="word" data-start="0.16" data-end="0.36" data-word-id="0">John</span>:<span class="word" data-start="0.56" data-end="0.76" data-word-id="1">playful</span>l]<span class="word" data-start="0.97" data-end="1.17" data-word-id="2">Who</span><span class="word" data-start="1.18" data-end="1.38" data-word-id="3">am</span><span class="word" data-start="1.39" data-end="1.5899999999999999" data-word-id="4">I</span>?<span class="word" data-start="1.8099999999999998" data-end="1.87" data-word-id="5">I</span><span class="word" data-start="1.87" data-end="2.02" data-word-id="6">am</span><span class="word" data-start="2.02" data-end="2.06" data-word-id="7">a</span><span class="word" data-start="2.06" data-end="2.65" data-word-id="8">little</span><span class="word" data-start="2.68" data-end="3.0" data-word-id="9">old</span><span class="word" data-start="3.0" data-end="3.61" data-word-id="10">lady</span>.<span class="word" data-start="3.91" data-end="4.13" data-word-id="11">My</span><span class="word" data-start="4.13" data-end="4.64" data-word-id="12">hair</span><span class="word" data-start="4.64" data-end="4.81" data-word-id="13">is</span><span class="word" data-start="4.81" data-end="5.34" data-word-id="14">white</span>.<span class="word" data-start="5.69" data-end="5.87" data-word-id="15">I</span><span class="word" data-start="5.87" data-end="6.06" data-word-id="16">have</span><span class="word" data-start="6.06" data-end="6.25" data-word-id="17">got</span><span class="word" data-start="6.25" data-end="6.33" data-word-id="18">a</span><span class="word" data-start="6.33" data-end="6.91" data-word-id="19">small</span><span class="word" data-start="6.91" data-end="7.55" data-word-id="20">crown</span><span class="word" data-start="7.55" data-end="7.81" data-word-id="21">and</span><span class="word" data-start="7.81" data-end="7.86" data-word-id="22">a</span><span class="word" data-start="7.86" data-end="8.31" data-word-id="23">black</span><span class="word" data-start="8.31" data-end="9.2" data-word-id="24">handbag</span>.<span class="word" data-start="9.54" data-end="9.74" data-word-id="25">My</span><span class="word" data-start="9.74" data-end="10.24" data-word-id="26">dress</span><span class="word" data-start="10.24" data-end="10.39" data-word-id="27">is</span><span class="word" data-start="10.39" data-end="11.05" data-word-id="28">blue</span>.<span class="word" data-start="11.39" data-end="11.58" data-word-id="29">My</span><span class="word" data-start="11.58" data-end="12.13" data-word-id="30">country's</span><span class="word" data-start="12.13" data-end="12.67" data-word-id="31">flag</span><span class="word" data-start="12.67" data-end="12.84" data-word-id="32">is</span><span class="word" data-start="12.84" data-end="13.32" data-word-id="33">red</span>,<span class="word" data-start="13.53" data-end="13.9" data-word-id="34">white</span><span class="word" data-start="13.97" data-end="14.2" data-word-id="35">and</span><span class="word" data-start="14.2" data-end="14.69" data-word-id="36">blue</span>.<span class="word" data-start="15.16" data-end="15.35" data-word-id="37">I</span><span class="word" data-start="15.35" data-end="15.53" data-word-id="38">am</span><span class="word" data-start="15.53" data-end="15.86" data-word-id="39">on</span><span class="word" data-start="15.86" data-end="16.17" data-word-id="40">many</span><span class="word" data-start="16.17" data-end="16.87" data-word-id="41">coins</span><span class="word" data-start="16.87" data-end="17.02" data-word-id="42">and</span><span class="word" data-start="17.02" data-end="17.75" data-word-id="43">stamps</span>.<span class="word" data-start="18.22" data-end="18.45" data-word-id="44">I</span><span class="word" data-start="18.45" data-end="19.2" data-word-id="45">love</span><span class="word" data-start="19.2" data-end="19.85" data-word-id="46">dogs</span>–<span class="word" data-start="20.13" data-end="20.36" data-word-id="47">my</span><span class="word" data-start="20.36" data-end="20.56" data-word-id="48">dogs'</span><span class="word" data-start="20.56" data-end="20.759999999999998" data-word-id="49">names</span><span class="word" data-start="21.32" data-end="21.52" data-word-id="50">are</span><span class="word" data-start="21.52" data-end="21.72" data-word-id="51">corgis</span>!<span class="word" data-start="22.75" data-end="23.01" data-word-id="52">Who</span><span class="word" data-start="23.01" data-end="23.22" data-word-id="53">am</span><span class="word" data-start="23.22" data-end="23.65" data-word-id="54">I</span>?<span class="word" data-start="27.89" data-end="28.55" data-word-id="55">Samantha</span>:<span class="word" data-start="28.75" data-end="28.95" data-word-id="56">amused</span>d]<span class="word" data-start="29.16" data-end="29.36" data-word-id="57">Queen</span><span class="word" data-start="29.37" data-end="29.57" data-word-id="58">Elizabeth</span><span class="word" data-start="29.580000000000002" data-end="29.78" data-word-id="59">II</span>!!!<span class="word" data-start="30.000000000000004" data-end="30.200000000000003" data-word-id="60">John</span>:<span class="word" data-start="30.420000000000005" data-end="30.620000000000005" data-word-id="61">smiling</span>g]<span class="word" data-start="55.76" data-end="56.61" data-word-id="62">Correct</span>,<span class="word" data-start="56.81" data-end="57.010000000000005" data-word-id="63">Samantha</span>!<span class="word" data-start="57.220000000000006" data-end="57.38" data-word-id="64">Your</span><span class="word" data-start="57.43" data-end="57.66" data-word-id="65">turn</span><span class="word" data-start="57.669999999999995" data-end="57.87" data-word-id="66">now</span>—<span class="word" data-start="58.089999999999996" data-end="58.29" data-word-id="67">describe</span><span class="word" data-start="58.3" data-end="58.5" data-word-id="68">someone</span><span class="word" data-start="58.51" data-end="58.71" data-word-id="69">for</span><span class="word" data-start="58.72" data-end="58.92" data-word-id="70">me</span><span class="word" data-start="67.47" data-end="67.59" data-word-id="71">to</span><span class="word" data-start="67.60000000000001" data-end="67.80000000000001" data-word-id="72">guess</span>.<span class="word" data-start="68.02000000000002" data-end="68.22000000000003" data-word-id="73">Samantha</span>:<span class="word" data-start="68.44000000000004" data-end="68.64000000000004" data-word-id="74">thinking</span>g]<span class="word" data-start="68.86000000000006" data-end="69.06000000000006" data-word-id="75">Alright</span>…<span class="word" data-start="73.81" data-end="74.08" data-word-id="76">Who</span><span class="word" data-start="74.08" data-end="74.27" data-word-id="77">am</span><span class="word" data-start="74.27" data-end="74.73" data-word-id="78">I</span>?<span class="word" data-start="74.94000000000001" data-end="75.14000000000001" data-word-id="79">Im</span>m<span class="word" data-start="75.36000000000003" data-end="75.56000000000003" data-word-id="80">a</span><span class="word" data-start="75.57000000000004" data-end="75.77000000000004" data-word-id="81">famous</span><span class="word" data-start="75.78000000000004" data-end="75.98000000000005" data-word-id="82">scientist</span>.<span class="word" data-start="76.20000000000006" data-end="76.40000000000006" data-word-id="83">I</span><span class="word" data-start="76.41000000000007" data-end="76.61000000000007" data-word-id="84">was</span><span class="word" data-start="76.62000000000008" data-end="76.82000000000008" data-word-id="85">born</span><span class="word" data-start="76.83000000000008" data-end="77.03000000000009" data-word-id="86">in</span><span class="word" data-start="77.04000000000009" data-end="77.2400000000001" data-word-id="87">Germany</span>,<span class="word" data-start="77.46000000000011" data-end="77.66000000000011" data-word-id="88">but</span><span class="word" data-start="77.67000000000012" data-end="77.87000000000012" data-word-id="89">I</span><span class="word" data-start="77.88000000000012" data-end="78.08000000000013" data-word-id="90">later</span><span class="word" data-start="78.09000000000013" data-end="78.29000000000013" data-word-id="91">moved</span><span class="word" data-start="78.30000000000014" data-end="78.50000000000014" data-word-id="92">to</span><span class="word" data-start="78.51000000000015" data-end="78.71000000000015" data-word-id="93">the</span><span class="word" data-start="78.72000000000016" data-end="78.92000000000016" data-word-id="94">USA</span>.<span class="word" data-start="79.14000000000017" data-end="79.34000000000017" data-word-id="95">My</span><span class="word" data-start="79.35000000000018" data-end="79.55000000000018" data-word-id="96">hair</span><span class="word" data-start="79.56000000000019" data-end="79.76000000000019" data-word-id="97">was</span><span class="word" data-start="79.7700000000002" data-end="79.9700000000002" data-word-id="98">wild</span><span class="word" data-start="79.9800000000002" data-end="80.1800000000002" data-word-id="99">and</span><span class="word" data-start="80.19000000000021" data-end="80.39000000000021" data-word-id="100">white</span>,<span class="word" data-start="80.61000000000023" data-end="80.81000000000023" data-word-id="101">and</span><span class="word" data-start="80.82000000000023" data-end="81.02000000000024" data-word-id="102">I</span><span class="word" data-start="81.03000000000024" data-end="81.23000000000025" data-word-id="103">often</span><span class="word" data-start="81.24000000000025" data-end="81.44000000000025" data-word-id="104">stuck</span><span class="word" data-start="81.45000000000026" data-end="81.65000000000026" data-word-id="105">my</span><span class="word" data-start="81.66000000000027" data-end="81.86000000000027" data-word-id="106">tongue</span><span class="word" data-start="81.87000000000027" data-end="82.07000000000028" data-word-id="107">out</span><span class="word" data-start="82.08000000000028" data-end="82.28000000000029" data-word-id="108">in</span><span class="word" data-start="82.29000000000029" data-end="82.4900000000003" data-word-id="109">photos</span>.<span class="word" data-start="82.7100000000003" data-end="82.91000000000031" data-word-id="110">I</span><span class="word" data-start="82.92000000000031" data-end="83.12000000000032" data-word-id="111">developed</span><span class="word" data-start="83.13000000000032" data-end="83.33000000000033" data-word-id="112">the</span><span class="word" data-start="83.34000000000033" data-end="83.54000000000033" data-word-id="113">theory</span><span class="word" data-start="83.55000000000034" data-end="83.75000000000034" data-word-id="114">of</span><span class="word" data-start="83.76000000000035" data-end="83.96000000000035" data-word-id="115">relativity</span>.<span class="word" data-start="84.18000000000036" data-end="84.38000000000036" data-word-id="116">Who</span><span class="word" data-start="84.39000000000037" data-end="84.59000000000037" data-word-id="117">am</span><span class="word" data-start="84.60000000000038" data-end="84.80000000000038" data-word-id="118">I</span>?<span class="word" data-start="85.0200000000004" data-end="85.2200000000004" data-word-id="119">John</span>:<span class="word" data-start="85.44000000000041" data-end="85.64000000000041" data-word-id="120">grinning</span>g]<span class="word" data-start="85.86000000000043" data-end="86.06000000000043" data-word-id="121">Easy</span><span class="word" data-start="86.07000000000043" data-end="86.27000000000044" data-word-id="122">one</span>!<span class="word" data-start="86.49000000000045" data-end="86.69000000000045" data-word-id="123">Youre</span>e<span class="word" data-start="86.91000000000047" data-end="87.11000000000047" data-word-id="124">Albert</span><span class="word" data-start="87.12000000000047" data-end="87.32000000000048" data-word-id="125">Einstein</span>!<span class="word" data-start="87.54000000000049" data-end="87.74000000000049" data-word-id="126">Samantha</span>:<span class="word" data-start="87.9600000000005" data-end="88.16000000000051" data-word-id="127">laughing</span>g]<span class="word" data-start="88.38000000000052" data-end="88.58000000000052" data-word-id="128">Correct</span>!<span class="word" data-start="88.80000000000054" data-end="89.00000000000054" data-word-id="129">Okay</span>,<span class="word" data-start="89.22000000000055" data-end="89.42000000000056" data-word-id="130">your</span><span class="word" data-start="89.43000000000056" data-end="89.63000000000056" data-word-id="131">turn</span><span class="word" data-start="89.64000000000057" data-end="89.84000000000057" data-word-id="132">again</span>.<span class="word" data-start="90.06000000000058" data-end="90.26000000000059" data-word-id="133">John</span>:<span class="word" data-start="90.4800000000006" data-end="90.6800000000006" data-word-id="134">playful</span>l]<span class="word" data-start="90.90000000000062" data-end="91.10000000000062" data-word-id="135">Who</span><span class="word" data-start="91.11000000000062" data-end="91.31000000000063" data-word-id="136">am</span><span class="word" data-start="91.32000000000063" data-end="91.52000000000064" data-word-id="137">I</span>?<span class="word" data-start="91.74000000000065" data-end="91.94000000000065" data-word-id="138">I</span><span class="word" data-start="91.95000000000066" data-end="92.15000000000066" data-word-id="139">wear</span><span class="word" data-start="92.16000000000066" data-end="92.36000000000067" data-word-id="140">a</span><span class="word" data-start="92.37000000000067" data-end="92.57000000000068" data-word-id="141">red</span><span class="word" data-start="92.58000000000068" data-end="92.78000000000068" data-word-id="142">suit</span><span class="word" data-start="92.79000000000069" data-end="92.99000000000069" data-word-id="143">and</span><span class="word" data-start="93.0000000000007" data-end="93.2000000000007" data-word-id="144">a</span><span class="word" data-start="93.2100000000007" data-end="93.41000000000071" data-word-id="145">big</span><span class="word" data-start="93.42000000000071" data-end="93.62000000000072" data-word-id="146">black</span><span class="word" data-start="93.63000000000072" data-end="93.83000000000072" data-word-id="147">belt</span>.<span class="word" data-start="94.05000000000074" data-end="94.25000000000074" data-word-id="148">I</span><span class="word" data-start="94.26000000000074" data-end="94.46000000000075" data-word-id="149">have</span><span class="word" data-start="94.47000000000075" data-end="94.67000000000075" data-word-id="150">a</span><span class="word" data-start="94.68000000000076" data-end="94.88000000000076" data-word-id="151">long</span><span class="word" data-start="94.89000000000077" data-end="95.09000000000077" data-word-id="152">white</span><span class="word" data-start="95.10000000000078" data-end="95.30000000000078" data-word-id="153">beard</span>.<span class="word" data-start="95.52000000000079" data-end="95.7200000000008" data-word-id="154">I</span><span class="word" data-start="95.7300000000008" data-end="95.9300000000008" data-word-id="155">bring</span><span class="word" data-start="95.94000000000081" data-end="96.14000000000081" data-word-id="156">presents</span><span class="word" data-start="96.15000000000082" data-end="96.35000000000082" data-word-id="157">to</span><span class="word" data-start="96.36000000000082" data-end="96.56000000000083" data-word-id="158">children</span><span class="word" data-start="96.57000000000083" data-end="96.77000000000083" data-word-id="159">around</span><span class="word" data-start="96.78000000000084" data-end="96.98000000000084" data-word-id="160">the</span><span class="word" data-start="96.99000000000085" data-end="97.19000000000085" data-word-id="161">world</span><span class="word" data-start="97.20000000000086" data-end="97.40000000000086" data-word-id="162">on</span><span class="word" data-start="97.41000000000086" data-end="97.61000000000087" data-word-id="163">Christmas</span><span class="word" data-start="97.62000000000087" data-end="97.82000000000087" data-word-id="164">Eve</span>.<span class="word" data-start="98.04000000000089" data-end="98.24000000000089" data-word-id="165">I</span><span class="word" data-start="98.2500000000009" data-end="98.4500000000009" data-word-id="166">ride</span><span class="word" data-start="98.4600000000009" data-end="98.6600000000009" data-word-id="167">a</span><span class="word" data-start="98.67000000000091" data-end="98.87000000000091" data-word-id="168">sleigh</span><span class="word" data-start="98.88000000000092" data-end="99.08000000000092" data-word-id="169">pulled</span><span class="word" data-start="99.09000000000093" data-end="99.29000000000093" data-word-id="170">by</span><span class="word" data-start="99.30000000000094" data-end="99.50000000000094" data-word-id="171">reindeer</span>.<span class="word" data-start="99.72000000000095" data-end="99.92000000000095" data-word-id="172">Who</span><span class="word" data-start="99.93000000000096" data-end="100.13000000000096" data-word-id="173">am</span><span class="word" data-start="100.14000000000097" data-end="100.34000000000097" data-word-id="174">I</span>?<span class="word" data-start="100.56000000000098" data-end="100.76000000000099" data-word-id="175">Samantha</span>:<span class="word" data-start="100.980000000001" data-end="101.180000000001" data-word-id="176">excited</span>d]<span class="word" data-start="101.40000000000101" data-end="101.60000000000102" data-word-id="177">Santa</span><span class="word" data-start="101.61000000000102" data-end="101.81000000000103" data-word-id="178">Claus</span>!🎅<span class="word" data-start="102.24000000000105" data-end="102.44000000000105" data-word-id="179">John</span>:<span class="word" data-start="102.66000000000106" data-end="102.86000000000107" data-word-id="180">cheerful</span>l]<span class="word" data-start="103.08000000000108" data-end="103.28000000000108" data-word-id="181">Exactly</span>!</div>
  <script>
    const audio = document.getElementById("player");
    const words = document.querySelectorAll(".word");

    // Créer un cache des timings pour éviter le parsing répétitif
    const wordTimings = Array.from(words).map(w => ({
      element: w,
      start: parseFloat(w.dataset.start),
      end: parseFloat(w.dataset.end),
      wordId: w.dataset.wordId || Math.random() // fallback pour compatibilité
    }));

    // Optimisation pour mobile : limiter la fréquence des mises à jour
    let lastUpdateTime = 0;
    const updateThrottle = 100; // ms

    audio.addEventListener("timeupdate", () => {
      const now = Date.now();
      if (now - lastUpdateTime < updateThrottle) return;
      lastUpdateTime = now;

      const currentTime = audio.currentTime;

      // Enlever tous les highlights actuels
      wordTimings.forEach(word => word.element.classList.remove("highlight"));

      // Trouver le mot actuellement lu (le plus récent qui a commencé)
      let currentWord = null;
      let latestStart = -1;

      for (const word of wordTimings) {
        if (currentTime >= word.start && currentTime < word.end) {
          if (word.start > latestStart) {
            currentWord = word;
            latestStart = word.start;
          }
        }
      }

      // Surligner uniquement le mot courant
      if (currentWord) {
        currentWord.element.classList.add("highlight");

        // Défilement automatique sur mobile pour garder le mot visible
        if (window.innerWidth <= 768) {
          currentWord.element.scrollIntoView({
            behavior: 'smooth',
            block: 'center',
            inline: 'nearest'
          });
        }
      }
    });

    // Permettre de cliquer sur les mots pour naviguer dans l'audio
    words.forEach(word => {
      word.addEventListener("click", (e) => {
        e.preventDefault();
        const start = parseFloat(word.dataset.start);
        if (!isNaN(start)) {
          audio.currentTime = start;
          if (audio.paused) {
            audio.play().catch(err => console.log("Lecture automatique bloquée:", err));
          }
        }
      });

      // Amélioration tactile pour mobile
      word.addEventListener("touchstart", (e) => {
        e.target.style.transform = "scale(1.1)";
      });

      word.addEventListener("touchend", (e) => {
        setTimeout(() => {
          e.target.style.transform = "";
        }, 150);
      });
    });

    // Gérer les erreurs audio
    audio.addEventListener("error", (e) => {
      console.error("Erreur audio:", e);
      const transcript = document.getElementById("transcript");
      transcript.insertAdjacentHTML("beforebegin",
        '<div style="background: #ffe6e6; color: #d63031; padding: 1rem; border-radius: 8px; margin: 1rem 0;">' +
        'Impossible de charger le fichier audio. Vérifiez que le fichier existe et est accessible.' +
        '</div>'
      );
    });
  </script>
  <footer>
    <p>Generated by <a href="https://laurentftech.github.io/Podcast_generator" target="_blank">Podcast Generator</a></p>
  </footer>
</body>
</html>