<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Who am I?</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, sans-serif;
      max-width: 800px;
      margin: 1rem auto;
      padding: 0 1rem;
      line-height: 1.6;
      font-size: 16px;
    }

    h1 {
      margin-bottom: 0.5rem;
      font-size: 1.8rem;
    }

    h2 {
      margin-top: 0;
      color: #666;
      font-weight: normal;
      font-size: 1.1rem;
    }

    audio {
      width: 100%;
      margin: 1rem 0;
      min-height: 40px;
      background-color: #f5f5f5;
      border-radius: 8px;
    }

    #transcript {
      font-size: 1rem;
      line-height: 1.7;
      margin-bottom: 2rem;
    }

    .word {
      padding: 2px 4px;
      margin: 0 1px;
      transition: background 0.2s;
      cursor: pointer;
      border-radius: 3px;
      display: inline-block;
    }

    .highlight {
      background-color: #ffc107;
      color: #000;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(255, 193, 7, 0.3);
    }

    strong {
      color: #000;
      font-weight: 600;
    }

    em {
      color: #666;
      font-style: italic;
      font-size: 0.9em;
    }

    footer {
      margin-top: 3rem;
      text-align: center;
      font-size: 0.85rem;
      color: #888;
      padding-bottom: 1rem;
    }

    footer a {
      color: #555;
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    /* Améliorations pour mobile */
    @media (max-width: 768px) {
      body {
        margin: 0.5rem auto;
        padding: 0 0.75rem;
        font-size: 15px;
      }

      h1 {
        font-size: 1.5rem;
        margin-bottom: 0.3rem;
      }

      h2 {
        font-size: 1rem;
        margin-bottom: 1rem;
      }

      audio {
        margin: 0.75rem 0;
        min-height: 45px;
        border-radius: 12px;
        /* Force une hauteur minimum pour éviter la coupure */
        height: 45px;
      }

      #transcript {
        font-size: 0.95rem;
        line-height: 1.6;
      }

      .word {
        padding: 3px 5px;
        margin: 1px 2px;
        /* Améliorer la zone de touch sur mobile */
        min-height: 24px;
        display: inline-flex;
        align-items: center;
      }

      .highlight {
        box-shadow: 0 3px 6px rgba(255, 193, 7, 0.4);
        transform: scale(1.05);
      }

      strong {
        display: block;
        margin: 0.5rem 0 0.2rem 0;
        font-size: 1rem;
      }

      em {
        font-size: 0.85rem;
        margin-right: 0.5rem;
      }

      footer {
        margin-top: 2rem;
        font-size: 0.8rem;
      }
    }

    /* Très petits écrans */
    @media (max-width: 480px) {
      body {
        padding: 0 0.5rem;
        font-size: 14px;
      }

      h1 {
        font-size: 1.3rem;
      }

      audio {
        height: 50px;
        border-radius: 8px;
      }

      #transcript {
        font-size: 0.9rem;
      }

      .word {
        padding: 2px 4px;
        margin: 1px;
      }
    }

    /* Amélioration pour les contrôles audio sur tous les navigateurs */
    audio::-webkit-media-controls-panel {
      background-color: #f8f9fa;
    }

    audio::-webkit-media-controls-play-button,
    audio::-webkit-media-controls-pause-button {
      background-color: #2c5aa0;
      border-radius: 50%;
    }
  </style>
</head>
<body>
  <h1>Who am I?</h1>
  <h2>A simple demo of Podcast generator produced with Google Gemini</h2>
  <audio id="player" controls src="../sample2-gemini.mp3" preload="metadata">
    <p>Votre navigateur ne supporte pas l'élément audio. <a href="../sample2-gemini.mp3">Télécharger le fichier audio</a>.</p>
  </audio>
  <div id="transcript"><strong>John: </strong><em><playful></em> <span class="word" data-start="0.16" data-end="0.54" data-word-id="0">Who</span> <span class="word" data-start="0.54" data-end="0.77" data-word-id="1">am</span> <span class="word" data-start="0.77" data-end="1.22" data-word-id="2">I</span>? <span class="word" data-start="0.77" data-end="1.22" data-word-id="3">I</span> <span class="word" data-start="0.54" data-end="0.77" data-word-id="4">am</span> <span class="word" data-start="2.02" data-end="2.06" data-word-id="5">a</span> <span class="word" data-start="2.06" data-end="2.65" data-word-id="6">little</span> <span class="word" data-start="2.68" data-end="3.0" data-word-id="7">old</span> <span class="word" data-start="3.0" data-end="3.61" data-word-id="8">lady</span>. <span class="word" data-start="3.91" data-end="4.13" data-word-id="9">My</span> <span class="word" data-start="4.13" data-end="4.64" data-word-id="10">hair</span> <span class="word" data-start="4.64" data-end="4.81" data-word-id="11">is</span> <span class="word" data-start="4.81" data-end="5.34" data-word-id="12">white</span>. <span class="word" data-start="5.69" data-end="5.87" data-word-id="13">I</span> <span class="word" data-start="5.87" data-end="6.06" data-word-id="14">have</span> <span class="word" data-start="6.06" data-end="6.25" data-word-id="15">got</span> <span class="word" data-start="6.25" data-end="6.33" data-word-id="16">a</span> <span class="word" data-start="6.33" data-end="6.91" data-word-id="17">small</span> <span class="word" data-start="6.91" data-end="7.55" data-word-id="18">crown</span> <span class="word" data-start="7.55" data-end="7.81" data-word-id="19">and</span> <span class="word" data-start="7.81" data-end="7.86" data-word-id="20">a</span> <span class="word" data-start="7.86" data-end="8.31" data-word-id="21">black</span> <span class="word" data-start="8.31" data-end="9.2" data-word-id="22">handbag</span>. <span class="word" data-start="9.54" data-end="9.74" data-word-id="23">My</span> <span class="word" data-start="9.74" data-end="10.24" data-word-id="24">dress</span> <span class="word" data-start="10.24" data-end="10.39" data-word-id="25">is</span> <span class="word" data-start="10.39" data-end="11.05" data-word-id="26">blue</span>. <span class="word" data-start="11.39" data-end="11.58" data-word-id="27">My</span> <span class="word" data-start="11.58" data-end="12.13" data-word-id="28">country's</span> <span class="word" data-start="12.13" data-end="12.67" data-word-id="29">flag</span> <span class="word" data-start="12.67" data-end="12.84" data-word-id="30">is</span> <span class="word" data-start="12.84" data-end="13.32" data-word-id="31">red</span>, <span class="word" data-start="13.32" data-end="13.9" data-word-id="32">white</span> <span class="word" data-start="13.97" data-end="14.2" data-word-id="33">and</span> <span class="word" data-start="14.2" data-end="14.69" data-word-id="34">blue</span>. <span class="word" data-start="15.16" data-end="15.35" data-word-id="35">I</span> <span class="word" data-start="15.35" data-end="15.53" data-word-id="36">am</span> <span class="word" data-start="15.53" data-end="15.86" data-word-id="37">on</span> <span class="word" data-start="15.86" data-end="16.17" data-word-id="38">many</span> <span class="word" data-start="16.17" data-end="16.87" data-word-id="39">coins</span> <span class="word" data-start="16.87" data-end="17.02" data-word-id="40">and</span> <span class="word" data-start="17.02" data-end="17.75" data-word-id="41">stamps</span>. <span class="word" data-start="18.22" data-end="18.45" data-word-id="42">I</span> <span class="word" data-start="18.45" data-end="19.2" data-word-id="43">love</span> <span class="word" data-start="19.2" data-end="19.85" data-word-id="44">dogs</span> – <span class="word" data-start="20.13" data-end="20.36" data-word-id="45">my</span> <span class="word" data-start="19.2" data-end="19.85" data-word-id="46">dogs</span>' <span class="word" data-start="20.36" data-end="21.32" data-word-id="47">names</span> <span class="word" data-start="21.32" data-end="21.52" data-word-id="48">are</span> corgis! <span class="word" data-start="22.75" data-end="23.01" data-word-id="49">Who</span> <span class="word" data-start="23.01" data-end="23.22" data-word-id="50">am</span> <span class="word" data-start="23.22" data-end="23.65" data-word-id="51">I</span>?<br><strong>Samantha: </strong><em><amused></em> <span class="word" data-start="24.94" data-end="25.33" data-word-id="52">Queen</span> <span class="word" data-start="25.33" data-end="26.26" data-word-id="53">Elizabeth</span> <span class="word" data-start="26.49" data-end="26.76" data-word-id="54">II</span> !!!<br><strong>John: </strong><em><smiling></em> <span class="word" data-start="27.33" data-end="27.89" data-word-id="55">Correct</span>, <span class="word" data-start="27.89" data-end="28.55" data-word-id="56">Samantha</span>! <span class="word" data-start="28.78" data-end="29.03" data-word-id="57">Your</span> <span class="word" data-start="29.03" data-end="29.35" data-word-id="58">turn</span> <span class="word" data-start="29.35" data-end="29.68" data-word-id="59">now</span> — <span class="word" data-start="29.93" data-end="30.39" data-word-id="60">describe</span> <span class="word" data-start="30.39" data-end="30.76" data-word-id="61">someone</span> <span class="word" data-start="30.76" data-end="30.91" data-word-id="62">for</span> <span class="word" data-start="30.91" data-end="31.08" data-word-id="63">me</span> <span class="word" data-start="31.08" data-end="31.17" data-word-id="64">to</span> <span class="word" data-start="31.17" data-end="31.68" data-word-id="65">guess</span>.<br><strong>Samantha: </strong><em><thinking></em> <span class="word" data-start="32.02" data-end="32.77" data-word-id="66">Alright</span>… <span class="word" data-start="33.38" data-end="33.73" data-word-id="67">Who</span> <span class="word" data-start="33.8" data-end="34.08" data-word-id="68">am</span> <span class="word" data-start="34.08" data-end="34.41" data-word-id="69">I</span>? <span class="word" data-start="34.08" data-end="34.41" data-word-id="70">I</span>’<span class="word" data-start="33.8" data-end="34.08" data-word-id="71">m</span> <span class="word" data-start="35.22" data-end="35.29" data-word-id="72">a</span> <span class="word" data-start="35.29" data-end="35.79" data-word-id="73">famous</span> <span class="word" data-start="35.79" data-end="36.72" data-word-id="74">scientist</span>. <span class="word" data-start="37.05" data-end="37.16" data-word-id="75">I</span> <span class="word" data-start="37.16" data-end="37.36" data-word-id="76">was</span> <span class="word" data-start="37.36" data-end="37.67" data-word-id="77">born</span> <span class="word" data-start="37.67" data-end="37.77" data-word-id="78">in</span> <span class="word" data-start="37.87" data-end="38.54" data-word-id="79">Germany</span>, <span class="word" data-start="38.77" data-end="38.9" data-word-id="80">but</span> <span class="word" data-start="38.9" data-end="39.02" data-word-id="81">I</span> <span class="word" data-start="39.02" data-end="39.46" data-word-id="82">later</span> <span class="word" data-start="39.46" data-end="39.77" data-word-id="83">moved</span> <span class="word" data-start="39.77" data-end="39.88" data-word-id="84">to</span> <span class="word" data-start="39.88" data-end="39.99" data-word-id="85">the</span> <span class="word" data-start="39.99" data-end="40.88" data-word-id="86">USA</span>. <span class="word" data-start="41.37" data-end="41.6" data-word-id="87">My</span> <span class="word" data-start="41.6" data-end="42.04" data-word-id="88">hair</span> <span class="word" data-start="42.04" data-end="42.28" data-word-id="89">was</span> <span class="word" data-start="42.28" data-end="42.95" data-word-id="90">wild</span> <span class="word" data-start="42.95" data-end="43.17" data-word-id="91">and</span> <span class="word" data-start="43.17" data-end="43.62" data-word-id="92">white</span>, <span class="word" data-start="42.95" data-end="43.17" data-word-id="93">and</span> <span class="word" data-start="44.04" data-end="44.17" data-word-id="94">I</span> <span class="word" data-start="44.24" data-end="44.66" data-word-id="95">often</span> <span class="word" data-start="44.66" data-end="44.99" data-word-id="96">stuck</span> <span class="word" data-start="44.99" data-end="45.13" data-word-id="97">my</span> <span class="word" data-start="45.13" data-end="45.54" data-word-id="98">tongue</span> <span class="word" data-start="45.54" data-end="45.72" data-word-id="99">out</span> <span class="word" data-start="45.72" data-end="45.84" data-word-id="100">in</span> <span class="word" data-start="45.84" data-end="46.47" data-word-id="101">photos</span>. <span class="word" data-start="47.16" data-end="47.37" data-word-id="102">I</span> <span class="word" data-start="47.4" data-end="47.92" data-word-id="103">developed</span> <span class="word" data-start="47.92" data-end="48.02" data-word-id="104">the</span> <span class="word" data-start="48.02" data-end="48.57" data-word-id="105">theory</span> <span class="word" data-start="48.57" data-end="48.88" data-word-id="106">of</span> <span class="word" data-start="48.88" data-end="49.82" data-word-id="107">relativity</span>. <span class="word" data-start="50.08" data-end="50.41" data-word-id="108">Who</span> <span class="word" data-start="50.47" data-end="50.64" data-word-id="109">am</span> <span class="word" data-start="50.7" data-end="51.16" data-word-id="110">I</span>?<br><strong>John: </strong><em><grinning></em> <span class="word" data-start="51.83" data-end="52.27" data-word-id="111">Easy</span> <span class="word" data-start="52.27" data-end="52.63" data-word-id="112">one</span>! <span class="word" data-start="52.87" data-end="53.27" data-word-id="113">You</span>’re <span class="word" data-start="53.36" data-end="53.77" data-word-id="114">Albert</span> <span class="word" data-start="53.84" data-end="54.69" data-word-id="115">Einstein</span>!<br><strong>Samantha: </strong><em><laughing></em> <span class="word" data-start="55.76" data-end="56.61" data-word-id="116">Correct</span>! <span class="word" data-start="56.71" data-end="57.1" data-word-id="117">Okay</span>, <span class="word" data-start="57.1" data-end="57.38" data-word-id="118">your</span> <span class="word" data-start="57.43" data-end="57.66" data-word-id="119">turn</span> <span class="word" data-start="57.66" data-end="58.05" data-word-id="120">again</span>.<br><strong>John: </strong><em><playful></em> <span class="word" data-start="58.77" data-end="59.07" data-word-id="121">Who</span> <span class="word" data-start="59.07" data-end="59.26" data-word-id="122">am</span> <span class="word" data-start="59.26" data-end="59.64" data-word-id="123">I</span>? <span class="word" data-start="59.26" data-end="59.64" data-word-id="124">I</span> <span class="word" data-start="60.21" data-end="60.48" data-word-id="125">wear</span> <span class="word" data-start="60.48" data-end="60.57" data-word-id="126">a</span> <span class="word" data-start="60.57" data-end="61.06" data-word-id="127">red</span> <span class="word" data-start="61.06" data-end="61.59" data-word-id="128">suit</span> <span class="word" data-start="61.66" data-end="61.81" data-word-id="129">and</span> <span class="word" data-start="61.81" data-end="61.88" data-word-id="130">a</span> <span class="word" data-start="61.88" data-end="62.51" data-word-id="131">big</span> <span class="word" data-start="62.51" data-end="63.03" data-word-id="132">black</span> <span class="word" data-start="63.03" data-end="63.48" data-word-id="133">belt</span>. <span class="word" data-start="63.81" data-end="63.98" data-word-id="134">I</span> <span class="word" data-start="63.98" data-end="64.16" data-word-id="135">have</span> <span class="word" data-start="64.16" data-end="64.2" data-word-id="136">a</span> <span class="word" data-start="64.2" data-end="65.02" data-word-id="137">long</span> <span class="word" data-start="65.02" data-end="65.43" data-word-id="138">white</span> <span class="word" data-start="65.43" data-end="65.97" data-word-id="139">beard</span>. <span class="word" data-start="66.34" data-end="66.55" data-word-id="140">I</span> <span class="word" data-start="66.55" data-end="66.86" data-word-id="141">bring</span> <span class="word" data-start="66.86" data-end="67.47" data-word-id="142">presents</span> <span class="word" data-start="67.47" data-end="67.59" data-word-id="143">to</span> <span class="word" data-start="67.59" data-end="68.2" data-word-id="144">children</span> <span class="word" data-start="68.2" data-end="68.62" data-word-id="145">around</span> <span class="word" data-start="68.62" data-end="68.71" data-word-id="146">the</span> <span class="word" data-start="68.71" data-end="69.23" data-word-id="147">world</span> <span class="word" data-start="69.23" data-end="69.39" data-word-id="148">on</span> <span class="word" data-start="69.39" data-end="69.97" data-word-id="149">Christmas</span> <span class="word" data-start="69.97" data-end="70.46" data-word-id="150">Eve</span>. <span class="word" data-start="70.85" data-end="71.03" data-word-id="151">I</span> <span class="word" data-start="71.03" data-end="71.34" data-word-id="152">ride</span> <span class="word" data-start="71.34" data-end="71.42" data-word-id="153">a</span> <span class="word" data-start="71.42" data-end="72.04" data-word-id="154">sleigh</span> <span class="word" data-start="72.04" data-end="72.48" data-word-id="155">pulled</span> <span class="word" data-start="72.48" data-end="72.63" data-word-id="156">by</span> <span class="word" data-start="72.63" data-end="73.56" data-word-id="157">reindeer</span>. <span class="word" data-start="73.81" data-end="74.08" data-word-id="158">Who</span> <span class="word" data-start="74.08" data-end="74.27" data-word-id="159">am</span> <span class="word" data-start="74.27" data-end="74.73" data-word-id="160">I</span>?<br><strong>Samantha: </strong><em><excited></em> <span class="word" data-start="75.15" data-end="75.74" data-word-id="161">Santa</span> <span class="word" data-start="75.77" data-end="75.91" data-word-id="162">Claus</span>! 🎅<br><strong>John: </strong><em><cheerful></em> <span class="word" data-start="77.29" data-end="78.36" data-word-id="163">Exactly</span>!</div>
  <script>
    const audio = document.getElementById("player");
    const words = document.querySelectorAll(".word");

    // Créer un cache des timings pour éviter le parsing répétitif
    const wordTimings = Array.from(words).map(w => ({
      element: w,
      start: parseFloat(w.dataset.start),
      end: parseFloat(w.dataset.end),
      wordId: w.dataset.wordId || Math.random() // fallback pour compatibilité
    }));

    // Optimisation pour mobile : limiter la fréquence des mises à jour
    let lastUpdateTime = 0;
    const updateThrottle = 100; // ms

    audio.addEventListener("timeupdate", () => {
      const now = Date.now();
      if (now - lastUpdateTime < updateThrottle) return;
      lastUpdateTime = now;

      const currentTime = audio.currentTime;

      // Enlever tous les highlights actuels
      wordTimings.forEach(word => word.element.classList.remove("highlight"));

      // Trouver le mot actuellement lu (le plus récent qui a commencé)
      let currentWord = null;
      let latestStart = -1;

      for (const word of wordTimings) {
        if (currentTime >= word.start && currentTime < word.end) {
          if (word.start > latestStart) {
            currentWord = word;
            latestStart = word.start;
          }
        }
      }

      // Surligner uniquement le mot courant
      if (currentWord) {
        currentWord.element.classList.add("highlight");

        // Défilement automatique sur mobile pour garder le mot visible
        if (window.innerWidth <= 768) {
          currentWord.element.scrollIntoView({
            behavior: 'smooth',
            block: 'center',
            inline: 'nearest'
          });
        }
      }
    });

    // Permettre de cliquer sur les mots pour naviguer dans l'audio
    words.forEach(word => {
      word.addEventListener("click", (e) => {
        e.preventDefault();
        const start = parseFloat(word.dataset.start);
        if (!isNaN(start)) {
          audio.currentTime = start;
          if (audio.paused) {
            audio.play().catch(err => console.log("Lecture automatique bloquée:", err));
          }
        }
      });

      // Amélioration tactile pour mobile
      word.addEventListener("touchstart", (e) => {
        e.target.style.transform = "scale(1.1)";
      });

      word.addEventListener("touchend", (e) => {
        setTimeout(() => {
          e.target.style.transform = "";
        }, 150);
      });
    });

    // Gérer les erreurs audio
    audio.addEventListener("error", (e) => {
      console.error("Erreur audio:", e);
      const transcript = document.getElementById("transcript");
      transcript.insertAdjacentHTML("beforebegin",
        '<div style="background: #ffe6e6; color: #d63031; padding: 1rem; border-radius: 8px; margin: 1rem 0;">' +
        'Impossible de charger le fichier audio. Vérifiez que le fichier existe et est accessible.' +
        '</div>'
      );
    });
  </script>
  <footer>
    <p>Generated by <a href="https://laurentftech.github.io/Podcast_generator" target="_blank">Podcast Generator</a></p>
  </footer>
</body>
</html>